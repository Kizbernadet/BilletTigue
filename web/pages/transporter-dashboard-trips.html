<!DOCTYPE html>
<html lang="fr" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trajets - Dashboard Transporteur - BilletTigue</title>
    <link rel="icon" type="image/png" href="../public/images/logo/logo.png">
    <link href="../public/assets/css/style.css" rel="stylesheet">
    <link href="../public/assets/css/dashboard.css" rel="stylesheet">
    <link href="../public/assets/css/trajets.css" rel="stylesheet">
    <link href="../public/assets/css/trajets-modal.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <!-- Protection d'authentification -->
    <script src="../src/js/auth-protection.js"></script>
    <!-- Déconnexion sécurisée -->
    <script src="../src/js/secure-logout.js"></script>
    <!-- Affichage personnalisé du profil -->
    <script src="../src/js/profile-display.js"></script>
    <!-- Gestionnaire de statistiques transporteur -->
    <script src="../src/js/transporter-stats-manager.js"></script>

</head>
<body class="min-h-screen overflow-x-hidden">
  <div class="transporter-dashboard-container">
    <div class="transporter-dashboard-wrapper">
    <!-- Sidebar -->
    <aside class="transporter-sidebar">
      <!-- Logo -->
      <div class="logo">
        <img src="../public/images/logo/logo.png" alt="BilletTigue Logo" style="height:48px; width:auto;">
        <span>BilletTiguè</span>
      </div>
      <!-- Menu -->
      <nav class="menu">
        <ul>
          <li><a href="transporter-dashboard.html"><i class="fa-solid fa-chart-pie"></i> <span class="menu-label">Dashboard</span></a></li>
          <li><a href="transporter-dashboard-trips.html" class="active"><i class="fa-solid fa-route"></i> <span class="menu-label">Trajets</span></a></li>
          <li><a href="#"><i class="fa-solid fa-box"></i> <span class="menu-label">Colis</span></a></li>
          <li><a href="#"><i class="fa-solid fa-users"></i> <span class="menu-label">Clients</span></a></li>
          <li><a href="transporter-dashboard-reservations.html"><i class="fa-solid fa-file-invoice"></i> <span class="menu-label">Réservations</span></a></li>
          <li><a href="#"><i class="fa-solid fa-chart-line"></i> <span class="menu-label">Statistiques</span></a></li>
          <li><a href="#"><i class="fa-solid fa-cog"></i> <span class="menu-label">Paramètres</span></a></li>
          <li><a href="../index.html" class="logout-btn" title="Déconnexion"><i class="fa-solid fa-sign-out-alt"></i> <span class="menu-label">Déconnexion</span></a></li>
        </ul>
      </nav>
    </aside>
    
    <!-- Contenu principal -->
    <main class="transporter-dashboard-main">
      <div class="transporter-main-wrapper">
        <div class="transporter-title-bar">
          <h1><i class="fa-solid fa-route"></i> Gestion des Trajets</h1>
          <!-- Section profil -->
          <div class="profile-dropdown-wrapper">
            <button id="profileBtn" onclick="toggleProfileMenu()">
              <i class="ri-user-3-line"></i>
              <span>Transporteur XXX</span>
            </button>
            <ul class="profile-dropdown-menu" id="profileDropdown">
              <li>
                <a href="#" class="profile-dropdown-link">
                  <i class="ri-user-settings-line"></i>
                  Mon Profil
                </a>
              </li>
              <li>
                <a href="#" class="profile-dropdown-link">
                  <i class="ri-settings-3-line"></i>
                  Paramètres
                </a>
              </li>
              <li>
                <a href="#" class="profile-dropdown-link">
                  <i class="ri-notification-3-line"></i>
                  Notifications
                </a>
              </li>
              <li>
                <a href="../index.html" class="profile-dropdown-link logout-link">
                  <i class="ri-logout-box-r-line"></i>
                  Déconnexion
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="transporter-main-content">
          <!-- Section Trajets -->
          <div class="trajets-section">
            <!-- Header des trajets -->
             <!-- Statistiques rapides -->
            <div class="trajets-stats">
                <div class="stat-card">
                  <div class="stat-icon active">
                    <i class="fa-solid fa-play"></i>
                  </div>
                  <div class="stat-info">
                    <h3>En cours</h3>
                    <p class="stat-number">3</p>
                  </div>
                </div>
                <div class="stat-card">
                  <div class="stat-icon completed">
                    <i class="fa-solid fa-check"></i>
                  </div>
                  <div class="stat-info">
                    <h3>Terminés</h3>
                    <p class="stat-number">12</p>
                  </div>
                </div>
                <div class="stat-card">
                  <div class="stat-icon pending">
                    <i class="fa-solid fa-clock"></i>
                  </div>
                  <div class="stat-info">
                    <h3>En attente</h3>
                    <p class="stat-number">2</p>
                  </div>
                </div>
                <div class="stat-card">
                  <div class="stat-icon total">
                    <i class="fa-solid fa-chart-line"></i>
                  </div>
                  <div class="stat-info">
                    <h3>Total</h3>
                    <p class="stat-number">17</p>
                  </div>
                </div>
              </div>
            <div class="trajets-header">
              <div class="trajets-actions">
                <button class="btn-ajouter-trajet" onclick="ouvrirFormulaireTrajet()">
                  <i class="fa-solid fa-plus"></i>
                  Nouveau Trajet
                </button>
                <button class="btn-filtrer">
                  <i class="fa-solid fa-filter"></i>
                  Filtrer
                </button>
              </div>
            </div>

            <!-- Liste des trajets -->
            <div class="trajets-list">
              <div class="trajet-item-mini trajet-message-empty">
                <p class="capitalize border-black size-10">Aucun trajet disponible</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    </div>
  </div>

  <!-- Modal Profil Trajet -->
  <div id="trajetModal" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">
          <i class="fa-solid fa-route"></i>
          <span id="modalTrajetTitre">Profil du Trajet</span>
        </h2>
        <button class="modal-close" onclick="fermerModal()">
          <i class="fa-solid fa-times"></i>
        </button>
      </div>
      
      <div class="trajet-details">
        <div class="detail-section">
          <h3><i class="fa-solid fa-info-circle"></i> Informations Générales</h3>
          <div class="detail-items-container">
            <div class="detail-item">
              <span class="detail-label">Statut</span>
              <span class="detail-value" id="modalStatut">En cours</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Itinéraire</span>
              <span class="detail-value" id="modalItineraire">Dakar → Thiès</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Date de départ</span>
              <span class="detail-value" id="modalDate">18/12/2024</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Heure de départ</span>
              <span class="detail-value" id="modalHeure">08:00</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Prix par place</span>
              <span class="detail-value" id="modalPrix">2,500 FCFA</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Places disponibles</span>
              <span class="detail-value" id="modalPlaces">8/12</span>
            </div>
          </div>
        </div>
        
        <div class="detail-section">
          <h3><i class="fa-solid fa-bus"></i> Détails du Transport</h3>
          <div class="detail-items-container">
            <div class="detail-item">
              <span class="detail-label">Transporteur</span>
              <span class="detail-value" id="modalVehicule">Renault Kangoo</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Point de départ</span>
              <span class="detail-value" id="modalDeparturePoint">Non spécifié</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Point d'arrivée</span>
              <span class="detail-value" id="modalArrivalPoint">Non spécifié</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Accepte les colis</span>
              <span class="detail-value" id="modalAcceptsPackages">Oui</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Poids max. colis</span>
              <span class="detail-value" id="modalMaxPackageWeight">20 kg</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Date de création</span>
              <span class="detail-value" id="modalCreatedAt">18/12/2024</span>
            </div>
          </div>
        </div>
      </div>
      
      <div class="trajet-actions-modal">
        <button class="btn-modal btn-secondary" onclick="fermerModal()">
          <i class="fa-solid fa-times"></i>
          Fermer
        </button>
        <button class="btn-modal btn-primary" id="btnModifier" onclick="modifierTrajetModal()">
          <i class="fa-solid fa-edit"></i>
          Modifier
        </button>
        <button class="btn-modal btn-success" id="btnDemarrer" onclick="demarrerTrajetModal()" style="display: none;">
          <i class="fa-solid fa-play"></i>
          Démarrer
        </button>
        <button class="btn-modal btn-success" id="btnTerminer" onclick="terminerTrajetModal()" style="display: none;">
          <i class="fa-solid fa-check"></i>
          Terminer
        </button>
        <button class="btn-modal btn-secondary" id="btnRapport" onclick="genererRapportModal()" style="display: none;">
          <i class="fa-solid fa-file-alt"></i>
          Rapport
        </button>
        <button class="btn-modal btn-danger" id="btnSupprimer" onclick="supprimerTrajetModal()">
          <i class="fa-solid fa-trash"></i>
          Supprimer
        </button>
      </div>
    </div>
  </div>

  <!-- Modal Confirmation Suppression -->
  <div id="confirmationModal" class="modal-overlay">
    <div class="modal-content confirmation-modal">
      <div class="modal-header compact-header">
        <span class="modal-title-flex">
          <span class="modal-title !text-white">Confirmation de suppression</span>
        </span>
        <button class="modal-close" onclick="fermerConfirmationModal()">
          <i class="fa-solid fa-times"></i>
        </button>
      </div>
      <div class="flex-row confirmation-content">
        <div class="confirmation-icon-large">
          <i class="fa-solid fa-trash-alt"></i>
        </div>
        <div class="confirmation-texts">
          <h3 class="confirmation-question">Êtes-vous sûr de vouloir supprimer ce trajet&nbsp;?</h3>
          <div class="confirmation-warning">Cette action est irréversible.<br>Le trajet sera définitivement supprimé de votre liste.</div>
          <div class="trajet-info-preview-inline">
            <span id="confirmationTrajetInfo">Dakar → Thiès (2500 FCFA)</span>
          </div>
        </div>
      </div>
      <div class="confirmation-actions">
        <button class="btn-modal btn-secondary" onclick="fermerConfirmationModal()">
          <i class="fa-solid fa-times"></i>
          Annuler
        </button>
        <button class="btn-modal btn-danger" onclick="confirmerSuppression()">
          <i class="fa-solid fa-trash"></i>
          Supprimer définitivement
        </button>
      </div>
    </div>
  </div>

  <!-- Modal Formulaire Ajout Trajet -->
  <div id="formulaireTrajetModal" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">
          <i class="fa-solid fa-plus"></i>
          Nouveau Trajet
        </h2>
        <button class="modal-close" onclick="fermerFormulaireTrajet()">
          <i class="fa-solid fa-times"></i>
        </button>
      </div>
      
      <form id="formNouveauTrajet" onsubmit="soumettreFormulaireTrajet(event)">
        <!-- Informations Générales -->
        <div class="form-section">
          <h3><i class="fa-solid fa-info-circle"></i> Informations Générales</h3>
          <div class="form-grid">
            <div class="form-group">
              <label class="form-label">Ville de départ <span class="required">*</span></label>
              <input type="text" class="form-input" id="departure_city" name="departure_city" required placeholder="Ex: Dakar">
            </div>
            <div class="form-group">
              <label class="form-label">Ville d'arrivée <span class="required">*</span></label>
              <input type="text" class="form-input" id="arrival_city" name="arrival_city" required placeholder="Ex: Thiès">
            </div>
            <div class="form-group">
              <label class="form-label">Heure de départ <span class="required">*</span></label>
              <input type="time" class="form-input" id="departure_time" name="departure_time" required>
            </div>
          </div>
        </div>

        <!-- Dates multiples -->
        <div class="form-section">
          <h3><i class="fa-solid fa-calendar-days"></i> Dates de départ</h3>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">
                <input type="checkbox" id="multiple_dates" name="multiple_dates" onchange="toggleMultipleDates()">
                Créer plusieurs trajets avec des dates différentes
              </label>
            </div>
          </div>
          
          <!-- Mode date unique -->
          <div id="singleDateMode" class="form-grid">
            <div class="form-group">
              <label class="form-label">Date de départ <span class="required">*</span></label>
              <input type="date" class="form-input" id="departure_date" name="departure_date" required>
            </div>
          </div>
          
          <!-- Mode dates multiples -->
          <div id="multipleDatesMode" class="form-grid" style="display: none;">
            <div class="form-group">
              <label class="form-label">Dates de départ <span class="required">*</span></label>
              <div id="datesContainer">
                <div class="date-input-row">
                  <input type="date" class="form-input date-input" name="departure_dates[]" required>
                  <button type="button" class="btn-remove-date" onclick="removeDateInput(this)" style="display: none;">
                    <i class="fa-solid fa-times"></i>
                  </button>
                </div>
              </div>
              <button type="button" class="btn-add-date" onclick="addDateInput()">
                <i class="fa-solid fa-plus"></i> Ajouter une date
              </button>
            </div>
          </div>
        </div>

        <!-- Informations tarifaires -->
        <div class="form-section">
          <h3><i class="fa-solid fa-money-bill-wave"></i> Informations tarifaires</h3>
          <div class="form-grid">
            <div class="form-group">
              <label class="form-label">Prix par place (FCFA) <span class="required">*</span></label>
              <input type="number" class="form-input" id="price" name="price" required placeholder="Ex: 2500" min="100" step="0.01">
            </div>
            <div class="form-group">
              <label class="form-label">Nombre de places <span class="required">*</span></label>
              <input type="number" class="form-input" id="seats_count" name="seats_count" required placeholder="Ex: 12" min="1" max="50">
            </div>
          </div>
        </div>

        <!-- Points de départ et d'arrivée -->
        <div class="form-section">
          <h3><i class="fa-solid fa-location-dot"></i> Points de ramassage</h3>
          <div class="form-grid">
            <div class="form-group">
              <label class="form-label">Point de départ précis</label>
              <input type="text" class="form-input" id="departure_point" name="departure_point" placeholder="Ex: Gare routière Pompiers, Dakar">
            </div>
            <div class="form-group">
              <label class="form-label">Point d'arrivée précis</label>
              <input type="text" class="form-input" id="arrival_point" name="arrival_point" placeholder="Ex: Gare routière, Thiès">
            </div>
          </div>
        </div>

        <!-- Gestion des colis -->
        <div class="form-section">
          <h3><i class="fa-solid fa-box"></i> Transport de colis</h3>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">
                <input type="checkbox" id="accepts_packages" name="accepts_packages" checked onchange="togglePackageOptions()">
                Accepter les colis
              </label>
            </div>
          </div>
          <div id="packageOptions" class="form-grid">
            <div class="form-group">
              <label class="form-label">Poids maximum par colis (kg)</label>
              <input type="number" class="form-input" id="max_package_weight" name="max_package_weight" placeholder="Ex: 20" min="0" step="0.1">
            </div>
          </div>
        </div>

        <!-- Statut du trajet -->
        <div class="form-section">
          <h3><i class="fa-solid fa-circle-info"></i> Configuration</h3>
          <div class="form-grid">
            <div class="form-group">
              <label class="form-label">Statut initial</label>
              <select class="form-select" id="status" name="status">
                <option value="pending">En attente</option>
                <option value="active" selected>Actif</option>
                <option value="scheduled">Programmé</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Places disponibles</label>
              <input type="number" class="form-input" id="available_seats" name="available_seats" placeholder="Sera égal au nombre de places" readonly>
            </div>
          </div>
        </div>

        <!-- Messages d'erreur/succès -->
        <div id="formMessages"></div>

        <!-- Actions du formulaire -->
        <div class="form-actions">
          <button type="button" class="btn-modal btn-secondary" onclick="fermerFormulaireTrajet()">
            <i class="fa-solid fa-times"></i>
            Annuler
          </button>
          <button type="button" class="btn-modal btn-secondary" onclick="reinitialiserFormulaire()">
            <i class="fa-solid fa-undo"></i>
            Réinitialiser
          </button>
          <button type="submit" class="btn-modal btn-success">
            <i class="fa-solid fa-save"></i>
            Créer le Trajet
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modale Voir Trajet -->
  <div id="modalVoirTrajet" class="modal-overlay" style="display:none;">
    <div class="modal-container">
      <div class="modal-header">
        <h2><i class="ri-eye-line"></i> Détails du trajet</h2>
        <button class="modal-close" onclick="fermerModalVoirTrajet()"><i class="ri-close-line"></i></button>
      </div>
      <div class="modal-body" id="voirTrajetContent">
        <!-- Les infos du trajet seront injectées ici -->
      </div>
      <div class="modal-footer">
        <button class="btn-modal btn-secondary" onclick="fermerModalVoirTrajet()"><i class="ri-close-line"></i> Fermer</button>
      </div>
    </div>
  </div>

  <!-- Modale Modifier Trajet -->
  <div id="modalEditTrajet" class="modal-overlay" style="display:none;">
    <div class="modal-container">
      <div class="modal-header">
        <h2><i class="ri-edit-line"></i> Modifier le trajet</h2>
        <button class="modal-close" onclick="fermerModalEditTrajet()"><i class="ri-close-line"></i></button>
      </div>
      <form id="formEditTrajet" class="modal-body" style="font-family: 'Comfortaa', cursive;">
        <!-- Champs pré-remplis JS -->
      </form>
      <div class="modal-footer">
        <button type="button" class="btn-modal btn-secondary" onclick="fermerModalEditTrajet()"><i class="ri-close-line"></i> Annuler</button>
        <button type="submit" form="formEditTrajet" class="btn-modal btn-primary"><i class="ri-save-line"></i> Enregistrer</button>
      </div>
    </div>
  </div>

  <!-- Modale Confirmation Suppression -->
  <div id="modalDeleteTrajet" class="modal-overlay" style="display:none;">
    <div class="modal-container">
      <div class="modal-header">
        <h2 style="color:#dc3545;"><i class="ri-delete-bin-6-line"></i> Supprimer ce trajet ?</h2>
        <button class="modal-close" onclick="fermerModalDeleteTrajet()"><i class="ri-close-line"></i></button>
      </div>
      <div class="modal-body" style="text-align:center;">
        <p style="color:#dc3545;">Cette action est irréversible.<br>Voulez-vous vraiment supprimer ce trajet ?</p>
      </div>
      <div class="modal-footer">
        <button class="btn-modal btn-secondary" onclick="fermerModalDeleteTrajet()">Annuler</button>
        <button class="btn-modal btn-danger" id="btnConfirmerSuppression"><i class="ri-delete-bin-6-line"></i> Oui, supprimer</button>
      </div>
    </div>
  </div>

  <script>
    // Activer la protection d'authentification
    AuthProtection.protect();
    
    // Initialiser l'affichage personnalisé du profil
    ProfileDisplay.init();
    
    // Initialiser les statistiques dynamiques transporteur
    (async function() {
      if (window.TransporterStatsManager) {
        console.log('🚛 Initialisation des statistiques transporteur dynamiques...');
        window.transporterStatsManager = new TransporterStatsManager();
        await window.transporterStatsManager.init();
      } else {
        console.warn('⚠️ Gestionnaire de statistiques transporteur non disponible, valeurs statiques conservées');
      }
      
      // Charger la liste des trajets au démarrage
      console.log('🚛 Chargement initial des trajets...');
      setTimeout(async () => {
        if (typeof window.rechargeTrajets === 'function') {
          await window.rechargeTrajets();
        } else {
          console.warn('⚠️ Fonction rechargeTrajets non disponible, tentative dans 500ms...');
          setTimeout(async () => {
            if (typeof window.rechargeTrajets === 'function') {
              await window.rechargeTrajets();
            }
          }, 500);
        }
      }, 100);
    })();

    // Fonctions pour le formulaire de trajet
    function togglePackageOptions() {
      const checkbox = document.getElementById('accepts_packages');
      const options = document.getElementById('packageOptions');
      const weightInput = document.getElementById('max_package_weight');
      
      if (checkbox.checked) {
        options.style.display = 'block';
        weightInput.value = weightInput.value || '20'; // Valeur par défaut
      } else {
        options.style.display = 'none';
        weightInput.value = '';
      }
    }

    // Synchroniser le nombre de places avec les places disponibles
    function syncAvailableSeats() {
      const seatsCount = document.getElementById('seats_count');
      const availableSeats = document.getElementById('available_seats');
      
      if (seatsCount && availableSeats) {
        availableSeats.value = seatsCount.value;
      }
    }

    // Initialiser les événements du formulaire
    document.addEventListener('DOMContentLoaded', function() {
      // Synchroniser les places au changement
      const seatsInput = document.getElementById('seats_count');
      if (seatsInput) {
        seatsInput.addEventListener('input', syncAvailableSeats);
      }
      
      // Initialiser l'état des options de colis
      togglePackageOptions();
      
      // Initialiser l'état des dates multiples
      toggleMultipleDates();
    });

    // Fonctions pour les dates multiples
    function toggleMultipleDates() {
      const checkbox = document.getElementById('multiple_dates');
      const singleMode = document.getElementById('singleDateMode');
      const multipleMode = document.getElementById('multipleDatesMode');
      
      if (checkbox.checked) {
        singleMode.style.display = 'none';
        multipleMode.style.display = 'block';
        
        // Désactiver la validation sur la date unique
        const singleDateInput = document.getElementById('departure_date');
        if (singleDateInput) {
          singleDateInput.removeAttribute('required');
        }
        
        // Activer la validation sur les dates multiples
        const dateInputs = document.querySelectorAll('input[name="departure_dates[]"]');
        dateInputs.forEach(input => input.setAttribute('required', ''));
        
      } else {
        singleMode.style.display = 'block';
        multipleMode.style.display = 'none';
        
        // Activer la validation sur la date unique
        const singleDateInput = document.getElementById('departure_date');
        if (singleDateInput) {
          singleDateInput.setAttribute('required', '');
        }
        
        // Désactiver la validation sur les dates multiples
        const dateInputs = document.querySelectorAll('input[name="departure_dates[]"]');
        dateInputs.forEach(input => input.removeAttribute('required'));
      }
    }

    function addDateInput() {
      const container = document.getElementById('datesContainer');
      const newRow = document.createElement('div');
      newRow.className = 'date-input-row';
      
      newRow.innerHTML = `
        <input type="date" class="form-input date-input" name="departure_dates[]" required>
        <button type="button" class="btn-remove-date" onclick="removeDateInput(this)">
          <i class="fa-solid fa-times"></i>
        </button>
      `;
      
      container.appendChild(newRow);
      
      // Afficher tous les boutons de suppression sauf pour le premier
      const removeButtons = container.querySelectorAll('.btn-remove-date');
      removeButtons.forEach((btn, index) => {
        btn.style.display = index === 0 ? 'none' : 'block';
      });
    }

    function removeDateInput(button) {
      const row = button.parentElement;
      const container = document.getElementById('datesContainer');
      
      if (container.children.length > 1) {
        row.remove();
        
        // Masquer le bouton de suppression du premier élément s'il n'y en a qu'un
        const removeButtons = container.querySelectorAll('.btn-remove-date');
        if (removeButtons.length === 1) {
          removeButtons[0].style.display = 'none';
        }
      }
    }
  </script>
  
  <!-- API d'authentification -->
  <script src="../src/js/api/authApi.js"></script>
  
  <!-- API client pour les trajets (version simple - script classique) -->
  <script src="../src/js/trajets-api-simple.js"></script>
  
  <!-- Script de gestion des modales de trajets -->
  <script src="../src/js/trajets-modal.js"></script>
  
  <!-- Vérification du chargement -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      console.log('🔍 Vérification du chargement des scripts...');
      
      // Vérifier que l'API est disponible
      if (typeof window.TrajetsApi === 'object') {
        console.log('✅ TrajetsApi disponible');
      } else {
        console.error('❌ TrajetsApi non disponible');
      }
      
      // Vérifier que toutes les fonctions sont disponibles
      if (typeof window.ouvrirFormulaireTrajet === 'function') {
        console.log('✅ Fonction ouvrirFormulaireTrajet disponible');
      } else {
        console.error('❌ Fonction ouvrirFormulaireTrajet non disponible');
      }
      
      console.log('✅ Vérification terminée');
    });
  </script>
</body>
</html> 