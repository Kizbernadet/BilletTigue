# üìë Documentation des Diagrammes de S√©quence - BilletTigue

Cette documentation d√©crit les diagrammes de s√©quence indispensables √† r√©aliser pour le projet BilletTigue. Pour chaque diagramme, sont pr√©cis√©s : le contexte, les acteurs, le sc√©nario √† mod√©liser, les points cl√©s √† repr√©senter, une description textuelle d√©taill√©e (sc√©nario nominal, sc√©narios d'exception, explication).

---

## 1. S√©quence d‚Äôinscription et d‚Äôauthentification

**Contexte :** Cr√©ation de compte et connexion pour tous les types d‚Äôacteurs (utilisateur, transporteur, administrateur).

**Acteurs :** Utilisateur/Transporteur/Administrateur, Syst√®me (Backend/API)

**Sc√©nario √† mod√©liser :**
- Saisie des informations d‚Äôinscription ou de connexion
- Validation des donn√©es c√¥t√© client puis c√¥t√© serveur
- Cr√©ation du compte ou v√©rification des identifiants
- G√©n√©ration et retour du token JWT
- Gestion des erreurs (donn√©es invalides, compte existant, etc.)

**Points cl√©s √† repr√©senter :**
- Encha√Ænement des messages entre frontend, backend, base de donn√©es
- Gestion des statuts de r√©ponse (succ√®s/√©chec)
- Stockage du token c√¥t√© client

**Description d√©taill√©e :**
- **Sc√©nario nominal :** L'utilisateur saisit ses informations (inscription ou connexion). Les donn√©es sont valid√©es c√¥t√© client puis envoy√©es au backend. Le backend v√©rifie (ou cr√©e) le compte dans la base de donn√©es. Si tout est correct, un token JWT est g√©n√©r√© et renvoy√© au frontend, qui le stocke et affiche la r√©ussite √† l'utilisateur.
- **Sc√©narios d'exception :**
  - Donn√©es invalides c√¥t√© client (ex : email mal form√©, mot de passe trop court) : message d'erreur imm√©diat.
  - Donn√©es invalides c√¥t√© serveur (ex : email d√©j√† utilis√©, mot de passe incorrect) : message d'erreur renvoy√© par l'API.
  - Probl√®me de connexion √† la base de donn√©es ou erreur serveur : message d'erreur g√©n√©rique.
- **Explication :** Ce diagramme illustre la robustesse du processus d'authentification, la gestion des erreurs √† chaque √©tape et la s√©curisation de la session utilisateur via JWT.

**Illustration :**
```mermaid
sequenceDiagram
actor U as "Utilisateur"
participant F as "Frontend"
participant B as "Backend/API"
participant DB as "Base de donn√©es"
U->>F: Saisie des infos d'inscription/connexion
F->>B: Envoie des donn√©es
B->>DB: V√©rifie/cr√©e le compte
DB-->>B: R√©sultat (succ√®s/√©chec)
B-->>F: Token JWT ou erreur
F-->>U: Affiche le r√©sultat, stocke le token
```

---

## 2. S√©quence de r√©servation d‚Äôun trajet

**Contexte :** Processus de r√©servation d‚Äôun trajet par un utilisateur.

**Acteurs :** Utilisateur, Syst√®me (Frontend, Backend), Transporteur

**Sc√©nario √† mod√©liser :**
- Recherche de trajets disponibles
- S√©lection d‚Äôun trajet
- Saisie des informations de r√©servation
- Validation des disponibilit√©s
- Cr√©ation de la r√©servation
- Notification du transporteur

**Points cl√©s √† repr√©senter :**
- Appels API pour la recherche et la r√©servation
- V√©rification des disponibilit√©s en temps r√©el
- Cr√©ation de la r√©servation en base
- Notification (email, push, etc.)

**Description d√©taill√©e :**
- **Sc√©nario nominal :** L'utilisateur recherche des trajets, s√©lectionne celui qui l'int√©resse, saisit les informations n√©cessaires et valide la r√©servation. Le backend v√©rifie la disponibilit√©, cr√©e la r√©servation et notifie le transporteur. L'utilisateur re√ßoit une confirmation.
- **Sc√©narios d'exception :**
  - Aucun trajet disponible : message d'information √† l'utilisateur.
  - Trajet s√©lectionn√© complet ou plus disponible : message d'erreur lors de la validation.
  - Erreur lors de la cr√©ation de la r√©servation (ex : probl√®me base de donn√©es) : message d'√©chec.
- **Explication :** Ce diagramme montre l'encha√Ænement des interactions pour garantir la coh√©rence des r√©servations, la gestion des disponibilit√©s et la notification des parties prenantes.

**Illustration :**
```mermaid
sequenceDiagram
actor U as "Utilisateur"
participant F as "Frontend"
participant B as "Backend/API"
participant DB as "Base de donn√©es"
participant T as "Transporteur"
U->>F: Recherche de trajets
F->>B: Requ√™te API trajets
B->>DB: Recherche trajets disponibles
DB-->>B: Liste trajets
B-->>F: R√©sultats
F-->>U: Affiche les trajets
U->>F: S√©lectionne un trajet, saisit infos
F->>B: Demande r√©servation
B->>DB: V√©rifie disponibilit√©, cr√©e r√©servation
DB-->>B: Confirmation
B-->>T: Notification nouvelle r√©servation
B-->>F: Confirmation √† l'utilisateur
F-->>U: Affiche confirmation
```

---

## 3. S√©quence de paiement d‚Äôune r√©servation

**Contexte :** Paiement d‚Äôune r√©servation par l‚Äôutilisateur.

**Acteurs :** Utilisateur, Syst√®me, Service de paiement externe, Transporteur

**Sc√©nario √† mod√©liser :**
- Demande de paiement depuis l‚Äôinterface utilisateur
- Transmission des informations au service de paiement (ex : Stripe)
- Validation ou refus du paiement
- Mise √† jour du statut de la r√©servation
- Notification du transporteur et de l‚Äôutilisateur

**Points cl√©s √† repr√©senter :**
- S√©curit√© des √©changes (donn√©es sensibles)
- Gestion des statuts de paiement (en attente, pay√©, √©chec)
- Synchronisation entre le service externe et la base de donn√©es

**Description d√©taill√©e :**
- **Sc√©nario nominal :** L'utilisateur initie le paiement, le backend transmet la demande au service de paiement. Si le paiement est valid√©, le statut de la r√©servation est mis √† jour et le transporteur est notifi√©. L'utilisateur re√ßoit une confirmation.
- **Sc√©narios d'exception :**
  - Paiement refus√© (fonds insuffisants, carte invalide, etc.) : message d'√©chec √† l'utilisateur, r√©servation non confirm√©e.
  - Probl√®me de communication avec le service de paiement : message d'erreur, possibilit√© de r√©essayer.
  - Erreur lors de la mise √† jour du statut en base : message d'erreur, paiement peut √™tre d√©bit√© mais r√©servation non valid√©e (√† traiter manuellement).
- **Explication :** Ce diagramme met en avant la s√©curit√© des transactions, la gestion des statuts et la synchronisation entre les syst√®mes internes et externes.

**Illustration :**
```mermaid
sequenceDiagram
actor U as "Utilisateur"
participant F as "Frontend"
participant B as "Backend/API"
participant P as "Service Paiement"
participant DB as "Base de donn√©es"
participant T as "Transporteur"
U->>F: Clique sur "Payer"
F->>B: Demande de paiement
B->>P: Transmet infos paiement
P-->>B: R√©ponse (succ√®s/√©chec)
B->>DB: Met √† jour statut r√©servation
B-->>T: Notification paiement re√ßu
B-->>F: Confirmation √† l'utilisateur
F-->>U: Affiche r√©sultat
```

---

## 4. S√©quence de gestion de profil

**Contexte :** Modification des informations de profil par un utilisateur, un transporteur ou un administrateur.

**Acteurs :** Utilisateur/Transporteur/Administrateur, Syst√®me

**Sc√©nario √† mod√©liser :**
- Saisie des nouvelles informations
- Validation c√¥t√© client et serveur
- Mise √† jour en base de donn√©es
- Retour d‚Äôinformation √† l‚Äôutilisateur

**Points cl√©s √† repr√©senter :**
- Gestion des erreurs de validation
- Confirmation de la mise √† jour

**Description d√©taill√©e :**
- **Sc√©nario nominal :** L'utilisateur modifie ses informations de profil, qui sont valid√©es puis enregistr√©es en base. Un message de confirmation est affich√©.
- **Sc√©narios d'exception :**
  - Donn√©es invalides (ex : email d√©j√† utilis√©, format incorrect) : message d'erreur.
  - Erreur lors de la mise √† jour en base : message d'√©chec, modification non prise en compte.
- **Explication :** Ce diagramme montre la simplicit√© et la robustesse du processus de modification de profil, avec gestion des erreurs et retour utilisateur.

**Illustration :**
```mermaid
sequenceDiagram
actor U as "Utilisateur/Transporteur/Admin"
participant F as "Frontend"
participant B as "Backend/API"
participant DB as "Base de donn√©es"
U->>F: Modifie infos profil
F->>B: Envoie nouvelles infos
B->>DB: Met √† jour profil
DB-->>B: Confirmation
B-->>F: R√©sultat (succ√®s/erreur)
F-->>U: Affiche confirmation
```

---

## 5. S√©quence de gestion des trajets (Transporteur)

**Contexte :** Cr√©ation, modification ou suppression d‚Äôun trajet par un transporteur.

**Acteurs :** Transporteur, Syst√®me

**Sc√©nario √† mod√©liser :**
- Saisie ou modification des informations du trajet
- Validation des donn√©es
- Cr√©ation, mise √† jour ou suppression en base
- Retour d‚Äôinformation √† l‚Äôutilisateur

**Points cl√©s √† repr√©senter :**
- Gestion des statuts des trajets (actif, en attente, termin√©)
- V√©rification des conflits de dates ou de disponibilit√©s

**Description d√©taill√©e :**
- **Sc√©nario nominal :** Le transporteur saisit ou modifie un trajet, les donn√©es sont valid√©es puis enregistr√©es en base. Un message de confirmation est affich√©.
- **Sc√©narios d'exception :**
  - Donn√©es invalides (ex : dates incoh√©rentes, nombre de places n√©gatif) : message d'erreur.
  - Conflit de disponibilit√© (trajet d√©j√† existant, chevauchement) : message d'erreur sp√©cifique.
  - Erreur lors de la mise √† jour en base : message d'√©chec.
- **Explication :** Ce diagramme met en avant la gestion des statuts, la validation m√©tier et la robustesse du processus de gestion des trajets.

**Illustration :**
```mermaid
sequenceDiagram
actor T as "Transporteur"
participant F as "Frontend"
participant B as "Backend/API"
participant DB as "Base de donn√©es"
T->>F: Saisie/modification trajet
F->>B: Envoie infos trajet
B->>DB: Cr√©e/modifie/supprime trajet
DB-->>B: Confirmation
B-->>F: R√©sultat (succ√®s/erreur)
F-->>T: Affiche confirmation
```

---

## 6. S√©quence de gestion des colis (optionnel)

**Contexte :** Demande d‚Äôenvoi de colis par un utilisateur, gestion par le transporteur.

**Acteurs :** Utilisateur, Transporteur, Syst√®me

**Sc√©nario √† mod√©liser :**
- Saisie de la demande d‚Äôenvoi
- Validation et affectation √† un trajet
- Notification du transporteur

**Points cl√©s √† repr√©senter :**
- V√©rification des contraintes (poids, volume, disponibilit√©)
- Suivi de l‚Äô√©tat du colis

**Description d√©taill√©e :**
- **Sc√©nario nominal :** L'utilisateur saisit une demande d'envoi de colis, le backend v√©rifie les contraintes et affecte le colis √† un trajet disponible. Le transporteur est notifi√© et l'utilisateur re√ßoit une confirmation.
- **Sc√©narios d'exception :**
  - Colis non conforme (poids/volume d√©pass√©) : message d'erreur.
  - Aucun trajet disponible pour le colis : message d'information.
  - Erreur lors de l'affectation ou de la notification : message d'√©chec.
- **Explication :** Ce diagramme illustre la gestion logistique des colis, la validation m√©tier et la notification des acteurs concern√©s.

**Illustration :**
```mermaid
sequenceDiagram
actor U as "Utilisateur"
participant F as "Frontend"
participant B as "Backend/API"
participant DB as "Base de donn√©es"
participant T as "Transporteur"
U->>F: Demande d'envoi de colis
F->>B: Envoie infos colis
B->>DB: V√©rifie contraintes, affecte √† un trajet
DB-->>B: Confirmation
B-->>T: Notification nouveau colis
B-->>F: Confirmation √† l'utilisateur
F-->>U: Affiche confirmation
```

---

## 7. S√©quence d‚Äôadministration (mod√©ration, gestion utilisateurs/transporteurs)

**Contexte :** Actions d‚Äôadministration sur les comptes et les droits.

**Acteurs :** Administrateur, Syst√®me

**Sc√©nario √† mod√©liser :**
- Suspension, d√©sactivation, modification de comptes
- Gestion des droits et notifications

**Points cl√©s √† repr√©senter :**
- Tra√ßabilit√© des actions
- Gestion des notifications et des logs

**Description d√©taill√©e :**
- **Sc√©nario nominal :** L'administrateur effectue une action (suspension, modification, etc.), le backend met √† jour la base, notifie les utilisateurs concern√©s et log l'action. Un message de confirmation est affich√©.
- **Sc√©narios d'exception :**
  - Action non autoris√©e (droits insuffisants) : message d'erreur.
  - Erreur lors de la mise √† jour ou de la notification : message d'√©chec, action logg√©e pour audit.
- **Explication :** Ce diagramme met en avant la s√©curit√©, la tra√ßabilit√© et la gouvernance des actions d'administration sur la plateforme.

**Illustration :**
```mermaid
sequenceDiagram
actor A as "Administrateur"
participant F as "Frontend"
participant B as "Backend/API"
participant DB as "Base de donn√©es"
A->>F: Action admin (suspendre, modifier...)
F->>B: Envoie requ√™te admin
B->>DB: Met √† jour compte/droits
DB-->>B: Confirmation
B-->>F: R√©sultat (succ√®s/erreur)
F-->>A: Affiche confirmation
B-->>DB: Log action admin
```

---

## Conseils de r√©alisation
- Pour chaque diagramme, repr√©senter clairement les messages, validations, retours d‚Äôerreur et mises √† jour d‚Äô√©tat.
- Utiliser des outils UML (draw.io, Lucidchart, StarUML) pour la mod√©lisation.
- Conserver les diagrammes dans le dossier `docs/uml/` du projet. 

---

### 1. Inscription et Authentification
```plantuml
@startuml
actor Utilisateur as U
participant "Frontend" as F
participant "Backend/API" as B
database "Base de donn√©es" as DB

U -> F : Saisie des infos d'inscription/connexion
F -> B : Envoie des donn√©es
B -> DB : V√©rifie/cr√©e le compte
DB --> B : R√©sultat (succ√®s/√©chec)
B --> F : Token JWT ou erreur
F --> U : Affiche le r√©sultat, stocke le token
@enduml
```

---

### 2. R√©servation d‚Äôun trajet
```plantuml
@startuml
actor Utilisateur as U
participant "Frontend" as F
participant "Backend/API" as B
database "Base de donn√©es" as DB
participant "Transporteur" as T

U -> F : Recherche de trajets
F -> B : Requ√™te API trajets
B -> DB : Recherche trajets disponibles
DB --> B : Liste trajets
B --> F : R√©sultats
F --> U : Affiche les trajets
U -> F : S√©lectionne un trajet, saisit infos
F -> B : Demande r√©servation
B -> DB : V√©rifie disponibilit√©, cr√©e r√©servation
DB --> B : Confirmation
B -> T : Notification nouvelle r√©servation
B --> F : Confirmation √† l'utilisateur
F --> U : Affiche confirmation
@enduml
```

---

### 3. Paiement d‚Äôune r√©servation
```plantuml
@startuml
actor Utilisateur as U
participant "Frontend" as F
participant "Backend/API" as B
participant "Service Paiement" as P
database "Base de donn√©es" as DB
participant "Transporteur" as T

U -> F : Clique sur "Payer"
F -> B : Demande de paiement
B -> P : Transmet infos paiement
P --> B : R√©ponse (succ√®s/√©chec)
B -> DB : Met √† jour statut r√©servation
B -> T : Notification paiement re√ßu
B --> F : Confirmation √† l'utilisateur
F --> U : Affiche r√©sultat
@enduml
```

---

### 4. Gestion de profil
```plantuml
@startuml
actor "Utilisateur/Transporteur/Admin" as U
participant "Frontend" as F
participant "Backend/API" as B
database "Base de donn√©es" as DB

U -> F : Modifie infos profil
F -> B : Envoie nouvelles infos
B -> DB : Met √† jour profil
DB --> B : Confirmation
B --> F : R√©sultat (succ√®s/erreur)
F --> U : Affiche confirmation
@enduml
```

---

### 5. Gestion des trajets (Transporteur)
```plantuml
@startuml
actor Transporteur as T
participant "Frontend" as F
participant "Backend/API" as B
database "Base de donn√©es" as DB

T -> F : Saisie/modification trajet
F -> B : Envoie infos trajet
B -> DB : Cr√©e/modifie/supprime trajet
DB --> B : Confirmation
B --> F : R√©sultat (succ√®s/erreur)
F --> T : Affiche confirmation
@enduml
```

---

### 6. Gestion des colis (optionnel)
```plantuml
@startuml
actor Utilisateur as U
participant "Frontend" as F
participant "Backend/API" as B
database "Base de donn√©es" as DB
participant "Transporteur" as T

U -> F : Demande d'envoi de colis
F -> B : Envoie infos colis
B -> DB : V√©rifie contraintes, affecte √† un trajet
DB --> B : Confirmation
B -> T : Notification nouveau colis
B --> F : Confirmation √† l'utilisateur
F --> U : Affiche confirmation
@enduml
```

---

### 7. Administration (mod√©ration, gestion comptes)
```plantuml
@startuml
actor Administrateur as A
participant "Frontend" as F
participant "Backend/API" as B
database "Base de donn√©es" as DB

A -> F : Action admin (suspendre, modifier...)
F -> B : Envoie requ√™te admin
B -> DB : Met √† jour compte/droits
DB --> B : Confirmation
B --> F : R√©sultat (succ√®s/erreur)
F --> A : Affiche confirmation
B -> DB : Log action admin
@enduml
```

---

**Si tu veux que je les ajoute √† un fichier ou √† la documentation, dis-le-moi !** 